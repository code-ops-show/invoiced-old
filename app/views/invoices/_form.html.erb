<div class="panel panel-default">
  <%= nested_form_for [@customer, @invoice] do |f| %>
  <div class="row">
    <div class="col-xs-12">
      <div class="rightBox">
        <address>
          <h4 class="gray">No.<%= @invoice.number %></h4>
        </address>
      </div>
      
      <div style="margin-left: 50px">
        <%= image_tag attachment_url(current_user, :logo_image, :fill, 150, 150, format: "jpg") %>
      </div>
      <div class="col-xs-6">
        <address class="box">
          
          <br><h5><%= current_user.first_name %> <%= current_user.last_name %></h5>
          <h5><%= @current_user.address %></h5>
          <h5><%= current_user.email %></h5>
        </address>
      </div>
      
      <div class="col-xs-6 text-right">
        <div class="rightBox">
          <address class="box">
            <h4>Billed To:</h4>
            <%= @customer.firstname %> <%= @customer.lastname %><br>
            <%= @customer.address %><br>
            <%= @customer.phone_number %><br>
            <%= @customer.email %>
          </address>
        </div>
        <div class="row">
          <div class="col-xs-5 col-md-push-6" >
            <strong>Issue Date:</strong>
            <%= f.text_field :issue_date, data: { provide: 'datepicker' }, class: "form-control" %><br>
            <strong>Due Date:</strong>
            <%= f.text_field :due_date, data: { provide: 'datepicker' }, class: "form-control" %><br><br>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-12 column calculate_amount">
    <table class="table table-hover">
      <thead>
        <tr>
          <th class="text-center">
            DESCRIPTION
          </th>
          <th class="text-center">
            QUANTITY
          </th>
          <th class="text-center">
            UNIT PRICE
          </th>
          <th class="text-center">
            AMOUNT
          </th>
          <th>
            <%= f.link_to_add '+Add Row', :line_items, data: { target: '#lineitems' } %>
          </th>
        </tr>
      </thead>
      <tbody id="lineitems">
        <%= f.fields_for :line_items, wrapper: false do |builder| %>
        <%= render 'line_item_fields', f: builder %>
        <% end %>
      </tbody>
    </table>
    <br>
    <div class="box">
      <h4 style="text-align: right">Sub Total : <span class="result"></span> Baht</h4>
      <h4 style="text-align: right">Vat 7% : <span class="vat"></span> Baht</h4>
      <h4 style="text-align: right">Balance : <span class="balance"></span> Baht</h4>
    </div>
  </div>
  <% if @invoice.persisted? %>
  <div class="col-md-12 column">
    <h3>Payment Information</h3><br>
    <table class="table table-hover">
      <thead>
        <tr>
          <th class="text-center">
            PAYMENT DATE
          </th>
          <th class="text-center">
            DESCRIPTION
          </th>
          <th class="text-center">
            METHOD
          </th>
          <th class="text-center">
            AMOUNT
          </th>
          <th>
            <%= f.link_to_add '+Add Row', :payments, data: { target: '#payments' } %>
          </th>
        </tr>
      </thead>
      <tbody id="payments">
        <%= f.fields_for :payments, wrapper: false do |item| %>
        <%= render "payment_fields", f: item %>
        <% end %>
      </tbody>
    </table>
    <br>
  </div>
  <div class="box">
    <h4 style="text-align: right">Total Paid : <%= @invoice.total_paid %> Baht<span class="result"></span></h4>
    <h4 style="text-align: right">Balance : <%= @invoice.balance %> Baht<span class="balance"></span></h4>
  </div>
  <% end %>
  <%= f.submit "Submit", class: "btn btn-success btn-lg center-block" %><br>
  <% end %>
</div>